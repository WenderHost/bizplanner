<!-- Vertical Form -->
<form class="row g-3" id="bizplanner-register">
  <div class="alert alert-danger response-message fade show" style="display: none;" role="alert"></div>
  <div class="col-md-6">
    <label for="fname" class="form-label">First Name</label>
    <input type="text" class="form-control" id="fname" name="fname" value="{{firstname}}" required>
  </div>
  <div class="col-md-6">
    <label for="lname" class="form-label">Last Name</label>
    <input type="text" class="form-control" id="lname" name="lname" value="{{lastname}}" required>
  </div>
  <div class="col-md-5">
    <label for="username" class="form-label">Grade</label>
    <select class="form-select" aria-label="Select your grade..." name="grade" required>
      <option selected="" value="">Select your grade...</option>
      <option value="4th"{{selected "4th" grade}}>4th</option>
      <option value="5th"{{selected "5th" grade}}>5th</option>
      <option value="6th"{{selected "6th" grade}}>6th</option>
      <option value="7th"{{selected "7th" grade}}>7th</option>
    </select>
  </div>
  <div class="col-md-7">
    <label for="school" class="form-label">School</label>
    <input type="text" class="form-control" id="school" name="school" value="{{school}}" placeholder="Enter your school..." required>
  </div>
  <div class="col-12">
    <label for="username" class="form-label">Username</label>
    <input type="text" class="form-control" id="username" name="username" value="{{username}}" autocapitalize="off" required>
  </div>
  <div class="col-12" style="">
    <label for="visiblePasswordField" class="form-label">Password</label>
    <div style="display: flex; flex-direction: row;">
      <input type="text" class="form-control" id="visiblePasswordField" oninput="updateHiddenPasswordField(event)" required style="width: 70%; border-radius: 3px 0 0 3px;"><button type="button" id="show-password" class="btn btn-primary btn-sm" style="border-radius: 0 3px 3px 0;" onclick="togglePasswordVisibility()"><i class="bi bi-eye-fill"></i> Show Password</button>
    </div>

    <input type="hidden" id="hiddenPasswordField" name="password">
    <style>
      #passwordMask {
        font-family: monospace; /* Ensure consistent character width */
        letter-spacing: .25ch;   /* Adjust as needed for character spacing */
      }
    </style>
    <script>
      var actualPassword = '';
      function updateHiddenPasswordField(event) {

        if ( event.inputType === "deleteContentBackward" ) {
          // Remove the last character from actualPassword
          actualPassword = actualPassword.slice(0, -1);
        } else {
          // Append the newly typed value to the existing actualPassword
          actualPassword += event.data;
        }

        // Update the hidden input with the actual password value
        document.getElementById("hiddenPasswordField").value = actualPassword;

        // Create a string with the same length as the password, filled with dots
        var maskedValue = '•'.repeat(actualPassword.length);
        document.getElementById("visiblePasswordField").value = maskedValue;
      }

      function togglePasswordVisibility() {
          var visiblePasswordField = document.getElementById("visiblePasswordField");
          var toggleButton = document.getElementById('show-password');

          // Toggle between actual password and masked value
          if (visiblePasswordField.value === actualPassword) {
              var maskedValue = '•'.repeat(actualPassword.length);
              visiblePasswordField.value = maskedValue;
              toggleButton.innerHTML = '<i class="bi bi-eye-fill"></i> Show Password';
          } else {
              visiblePasswordField.value = actualPassword;
              toggleButton.innerHTML = '<i class="bi bi-eye-slash-fill"></i> Hide Password';
          }
      }
    </script>
  </div>

  <div class="col-12">
    <label for="avatar" class="form-label">Your Avatar</label>
    <div class="row">
      <div class="col-3">
        <div class="avatar-frame"><img class="img-fluid" id="avatar" style="cursor: pointer;" src="{{bp_dir_uri}}lib/img/bizplanner-avatar_{{avatar}}.png" data-bs-toggle="modal" data-bs-target="#ExtralargeModal" /></div>
        <input type="hidden" name="avatar" id="selectedavatar" value="0" />
      </div>
      <div class="col-9">

        <!-- Extra Large Modal -->
        <button type="button" class="btn btn-outline-primary" data-bs-toggle="modal" data-bs-target="#ExtralargeModal">
          Select Your Avatar - Click Here
        </button>

        <div class="modal fade" id="ExtralargeModal" tabindex="-1">
          <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Select Your Avatar</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
              </div>
              <div class="modal-body" id="avatar-selector" style="background-color: #eee;">
                {{#each avatars}}
                  <img class="avatar-option" src="{{../bp_dir_uri}}lib/img/bizplanner-avatar_{{./}}.png" data-bpavatar="{{./}}" style="" data-bs-dismiss="modal" data-bs-target="#ExtralargeModal" />
                {{/each}}
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <!--<button type="button" class="btn btn-primary">Save changes</button>-->
              </div>
            </div>
          </div>
        </div><!-- End Extra Large Modal-->

      </div>
    </div>
  </div>
  <div class="text-left">
    <button type="submit" class="btn btn-primary">Save</button>
  </div>
</form><!-- Vertical Form -->