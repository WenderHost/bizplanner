function setCookie(e,n,t){var s=new Date,t=(s.setTime(s.getTime()+24*t*60*60*1e3),"expires="+s.toUTCString());document.cookie=e+"="+n+";"+t+";path=/"}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("start-new-plan");const t=document.getElementById("response-message"),s=document.getElementById("new-plan-button-text");e&&e.addEventListener("click",function(e){e.preventDefault(),s.innerHTML="Setting up plan...",t.innerHTML="One moment...";const n=new XMLHttpRequest;n.open("POST",bpapi.endpoint+"create",!0),n.setRequestHeader("X-WP-Nonce",bpapi.nonce),n.onload=function(){var e;console.log(n),200===n.status?(setCookie("bpid",JSON.parse(n.response).post_id,1),setTimeout(()=>{var e=window.location.origin+"/question/company-name/";window.location.href=e},500)):(e=JSON.parse(n.response),console.log("ðŸ›‘ xhr = ",n),console.log("ðŸ›‘ response = ",e),t&&(t.innerHTML=e.message))},n.send()})}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("bizplanner-form");var e=document.querySelectorAll("a.btn-nextprev"),n=document.querySelectorAll("#sidebar-nav a.nav-link");let s=!0;if(t){const i=t.querySelector("#bizplanner-form button[type='submit']"),l=t.querySelector("#bizplanner-form button[type='submit'] span"),d=document.getElementById("response-message");for(var o=t.elements,a=0;a<o.length;a++)"button"!==o[a].type&&o[a].addEventListener("change",function(){s=!1});function r(e){e&&e.preventDefault();e=new FormData(t);console.log("ðŸ”” formData =",e),d.innerHTML="",i.disabled=!0,l.innerHTML="Saving...";const n=new XMLHttpRequest;n.open("POST",bpapi.endpoint+"update",!0),n.setRequestHeader("X-WP-Nonce",bpapi.nonce),n.onload=function(){var e;200===n.status?(s=!0,console.log("AJAX request successful!"),console.log(n.responseText),i.disabled=!1,l.innerHTML="Saved!",setTimeout(()=>{l.innerHTML="Save"},1500)):(e=JSON.parse(n.response),console.log("ðŸ›‘ xhr = ",n),console.log("ðŸ›‘ response = ",e),i.disabled=!1,l.innerHTML="Not saved!",setTimeout(()=>{l.innerHTML="Save"},1500),d.innerHTML=e.message)},n.send(e)}t.addEventListener("submit",r),e.forEach(n=>{var t=n.href;n.addEventListener("click",e=>{s?console.log("Form is saved. Not auto-saving."):(e.preventDefault(),n.disabled=!0,n.innerHTML="Saving... One moment.",r(),setTimeout(()=>{window.location.href=t},2e3))})}),n.forEach(n=>{var t=n.href;n.addEventListener("click",e=>{s?console.log("Form is saved. Not auto-saving."):(e.preventDefault(),n.disabled=!0,r(),setTimeout(()=>{window.location.href=t},850))})}),t.addEventListener("blur",function(e){r()})}}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".bizplan a.delete-business-plan").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();e=this.getAttribute("data-bpid");if(console.log("ðŸ”” bpid = "+e),e){if(confirm("Are you sure you want to delete this business plan?")){const n=new XMLHttpRequest;n.open("DELETE",bpapi.endpoint+"delete/"+e,!0),n.setRequestHeader("X-WP-Nonce",bpapi.nonce),n.onload=function(){var e;200===n.status?location.reload():(e=JSON.parse(n.response),console.error("ðŸ›‘ xhr = ",n),console.error("ðŸ›‘ response = ",e))},n.send()}}else console.error("Business plan ID not found.")})})}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".bizplan a.btn").forEach(function(t){t.addEventListener("click",function(e){e.preventDefault();var n,e=this.getAttribute("href");(t.classList.contains("view-business-plan")||t.classList.contains("edit-business-plan"))&&(n=t.getAttribute("data-bpid"),console.log("ðŸ”” data-bpid:",n),setCookie("bpid",n,1),window.location.href=e)})})}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("bizplanner-login");if(t){const s=t.querySelector("#bizplanner-login button[type='submit']"),o=t.querySelector("#bizplanner-login .response-message");t.addEventListener("submit",function(e){e.preventDefault();e=new FormData(t);s.disabled=!0,s.innerHTML="One moment...";const n=new XMLHttpRequest;n.open("POST",bpapi.endpoint+"login",!0),n.setRequestHeader("X-WP-Nonce",bpapi.nonce),n.onload=function(){if(200===n.status){console.log("AJAX request successful!"),console.log(n.responseText);let e=JSON.parse(n.responseText);s.disabled=!1,console.log("response.data = ",e.data),o.style.display="block",o.innerHTML=e.message,o.classList="alert alert-success response-message fade show",setTimeout(()=>{s.innerHTML="Redirecting...",window.location.href=e.data.redirect_url},1500)}else{let e=JSON.parse(n.response);"block"==o.style.display?(o.style.display="none",setTimeout(()=>{s.disabled=!1,s.innerHTML="Log In",o.style.display="block",o.classList="alert alert-danger response-message fade show",o.innerHTML=e.message},300)):(s.disabled=!1,s.innerHTML="Log In",o.style.display="block",o.classList="alert alert-danger response-message fade show",o.innerHTML=e.message)}},n.send(e)})}}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("bizplanner-register");if(t){const s=t.querySelector("#bizplanner-register button[type='submit']"),o=t.querySelector("#bizplanner-register .response-message");t.addEventListener("submit",function(e){e.preventDefault();e=new FormData(t);s.disabled=!0,s.innerHTML="One moment...";const n=new XMLHttpRequest;n.open("POST",bpapi.endpoint+"register",!0),n.setRequestHeader("X-WP-Nonce",bpapi.nonce),n.onload=function(){if(200===n.status){console.log("AJAX request successful!"),console.log(n.responseText);let e=JSON.parse(n.responseText);s.disabled=!1,console.log("response = ",e),"block"==o.style.display&&(o.style.display="none"),o.style.display="block",o.classList="alert alert-success response-message fade show",o.innerHTML=e.message,setTimeout(()=>{s.innerHTML="Redirecting...",window.location.href=e.redirect_url},1500)}else{let e=JSON.parse(n.response);console.log("ðŸ›‘ xhr = ",n),console.log("ðŸ›‘ response = ",e),s.disabled=!1,s.innerHTML="Register","block"==o.style.display?(o.style.display="none",setTimeout(()=>{o.style.display="block",o.classList="alert alert-danger response-message fade show",o.innerHTML=e.message},300)):(o.style.display="block",o.classList="alert alert-danger response-message fade show",o.innerHTML=e.message)}},n.send(e)})}});const avatarOptions=document.querySelectorAll("#avatar-selector .avatar-option"),selectedAvatarInput=document.getElementById("selectedavatar"),avatarImage=document.getElementById("avatar");function handleAvatarOptionClick(e){avatarOptions.forEach(e=>{e.classList.remove("avatar-selected")});e=e.target,e.classList.add("avatar-selected"),e=e.getAttribute("data-bpavatar");selectedAvatarInput.value=e,avatarImage.src=bpapi.themedir+`lib/img/bizplanner-avatar_${e}.png`}function handleKeyUp(e){var n=document.querySelector(".form-control:focus"),t=document.getElementById("previous-question-btn"),s=document.getElementById("next-question-btn");s&&39===e.keyCode&&!n&&(s.classList.remove("btn-primary"),s.classList.add("btn-selected","btn-primary-outline"),window.setTimeout(function(){window.location.href=bpapi.next_question_url},300)),t&&37===e.keyCode&&!n&&(t.classList.remove("btn-primary"),t.classList.add("btn-selected","btn-primary-outline"),window.setTimeout(function(){window.location.href=bpapi.previous_question_url},300))}avatarOptions.forEach(e=>{e.addEventListener("click",handleAvatarOptionClick)}),document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("bizplanner-user-update");if(n){const s=n.querySelector(".response-message"),o=n.querySelector("button[type='submit']");n.addEventListener("submit",function(e){e.preventDefault();e=new FormData(n);o.disabled=!0,o.innerHTML="Updating...";const t=new XMLHttpRequest;t.open("POST",bpapi.endpoint+"updateuser",!0),t.setRequestHeader("X-WP-Nonce",bpapi.nonce),t.onload=function(){if(200===t.status){const e=JSON.parse(t.responseText);o.disabled=!1,o.innerHTML="Updated","block"===s.style.display?(s.style.display="none",setTimeout(()=>{s.style.display="block",s.classList="alert alert-success response-message fade show",s.innerHTML=e.message},300)):(s.style.display="block",s.classList="alert alert-success response-message fade show",s.innerHTML=e.message),o.innerHTML="Update",setTimeout(()=>{window.location.reload()},1500)}else{const n=JSON.parse(t.response);o.disabled=!1,o.innerHTML="Update","block"===s.style.display?(s.style.display="none",setTimeout(()=>{s.style.display="block",s.classList="alert alert-danger response-message fade show",s.innerHTML=n.message},300)):(s.style.display="block",s.classList="alert alert-danger response-message fade show",s.innerHTML=n.message)}},t.send(e)})}}),document.addEventListener("keyup",handleKeyUp),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("form#bizplanner-form input.form-control"),n=document.querySelector("form#bizplanner-form textarea.form-control");e&&e.focus(),n&&n.focus()});