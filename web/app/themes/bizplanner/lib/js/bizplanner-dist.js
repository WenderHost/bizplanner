function setCookie(e,n,t){var o=new Date,t=(o.setTime(o.getTime()+24*t*60*60*1e3),"expires="+o.toUTCString());document.cookie=e+"="+n+";"+t+";path=/"}document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("start-new-plan");const t=document.getElementById("response-message"),o=document.getElementById("new-plan-button-text");e&&e.addEventListener("click",function(e){e.preventDefault(),o.innerHTML="Setting up plan...",t.innerHTML="One moment. We're setting up your new business plan...";const n=new XMLHttpRequest;n.open("POST",bpapi.endpoint+"create",!0),n.setRequestHeader("X-WP-Nonce",bpapi.nonce),n.onload=function(){var e;console.log(n),200===n.status?(e=JSON.parse(n.response),t&&(t.innerHTML=""),t.innerHTML="Success! Your new plan is ready. Redirecting you, one moment...",setCookie("bpid",e.post_id,1),setTimeout(()=>{var e=window.location.origin+"/question/company-name/";window.location.href=e},500)):(e=JSON.parse(n.response),console.log("ðŸ›‘ xhr = ",n),console.log("ðŸ›‘ response = ",e),t&&(t.innerHTML=e.message))},n.send()})}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("bizplanner-form");var e=document.querySelectorAll("a.btn-nextprev"),n=document.querySelectorAll("#sidebar-nav a.nav-link");let o=!0;if(t){const i=t.querySelector("#bizplanner-form button[type='submit']"),l=t.querySelector("#bizplanner-form button[type='submit'] span"),d=document.getElementById("response-message");for(var s=t.elements,a=0;a<s.length;a++)"button"!==s[a].type&&s[a].addEventListener("change",function(){o=!1});function r(e){e&&e.preventDefault();e=new FormData(t);console.log("ðŸ”” formData =",e),d.innerHTML="",i.disabled=!0,l.innerHTML="Saving...";const n=new XMLHttpRequest;n.open("POST",bpapi.endpoint+"update",!0),n.setRequestHeader("X-WP-Nonce",bpapi.nonce),n.onload=function(){var e;200===n.status?(o=!0,console.log("AJAX request successful!"),console.log(n.responseText),i.disabled=!1,l.innerHTML="Saved!",setTimeout(()=>{l.innerHTML="Save"},1500)):(e=JSON.parse(n.response),console.log("ðŸ›‘ xhr = ",n),console.log("ðŸ›‘ response = ",e),i.disabled=!1,l.innerHTML="Not saved!",setTimeout(()=>{l.innerHTML="Save"},1500),d.innerHTML=e.message)},n.send(e)}t.addEventListener("submit",r),e.forEach(n=>{var t=n.href;n.addEventListener("click",e=>{o?console.log("Form is saved. Not auto-saving."):(e.preventDefault(),n.disabled=!0,n.innerHTML="Saving... One moment.",r(),setTimeout(()=>{window.location.href=t},2e3))})}),n.forEach(n=>{var t=n.href;n.addEventListener("click",e=>{o?console.log("Form is saved. Not auto-saving."):(e.preventDefault(),n.disabled=!0,r(),setTimeout(()=>{window.location.href=t},850))})}),t.addEventListener("blur",function(e){r()})}}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".bizplan a.delete-business-plan").forEach(function(e){e.addEventListener("click",function(e){e.preventDefault();e=this.getAttribute("data-bpid");if(console.log("ðŸ”” bpid = "+e),e){if(confirm("Are you sure you want to delete this business plan?")){const n=new XMLHttpRequest;n.open("DELETE",bpapi.endpoint+"delete/"+e,!0),n.setRequestHeader("X-WP-Nonce",bpapi.nonce),n.onload=function(){var e;200===n.status?location.reload():(e=JSON.parse(n.response),console.error("ðŸ›‘ xhr = ",n),console.error("ðŸ›‘ response = ",e))},n.send()}}else console.error("Business plan ID not found.")})})}),document.addEventListener("DOMContentLoaded",function(){document.querySelectorAll(".bizplan a.btn").forEach(function(t){t.addEventListener("click",function(e){e.preventDefault();var n,e=this.getAttribute("href");(t.classList.contains("view-business-plan")||t.classList.contains("edit-business-plan"))&&(n=t.getAttribute("data-bpid"),console.log("ðŸ”” data-bpid:",n),setCookie("bpid",n,1),window.location.href=e)})})}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("bizplanner-login");if(t){const o=t.querySelector("#bizplanner-login button[type='submit']"),s=t.querySelector("#bizplanner-login .response-message");t.addEventListener("submit",function(e){e.preventDefault();e=new FormData(t);o.disabled=!0,o.innerHTML="One moment...";const n=new XMLHttpRequest;n.open("POST",bpapi.endpoint+"login",!0),n.setRequestHeader("X-WP-Nonce",bpapi.nonce),n.onload=function(){if(200===n.status){console.log("AJAX request successful!"),console.log(n.responseText);let e=JSON.parse(n.responseText);o.disabled=!1,console.log("response.data = ",e.data),s.style.display="block",s.innerHTML=e.message,s.classList="alert alert-success response-message fade show",setTimeout(()=>{o.innerHTML="Redirecting...",window.location.href=e.data.redirect_url},1500)}else{let e=JSON.parse(n.response);"block"==s.style.display?(s.style.display="none",setTimeout(()=>{o.disabled=!1,o.innerHTML="Log In",s.style.display="block",s.classList="alert alert-danger response-message fade show",s.innerHTML=e.message},300)):(o.disabled=!1,o.innerHTML="Log In",s.style.display="block",s.classList="alert alert-danger response-message fade show",s.innerHTML=e.message)}},n.send(e)})}}),document.addEventListener("DOMContentLoaded",function(){const t=document.getElementById("bizplanner-register");if(t){const o=t.querySelector("#bizplanner-register button[type='submit']"),s=t.querySelector("#bizplanner-register .response-message");t.addEventListener("submit",function(e){e.preventDefault();e=new FormData(t);o.disabled=!0,o.innerHTML="One moment...";const n=new XMLHttpRequest;n.open("POST",bpapi.endpoint+"register",!0),n.setRequestHeader("X-WP-Nonce",bpapi.nonce),n.onload=function(){if(200===n.status){console.log("AJAX request successful!"),console.log(n.responseText);let e=JSON.parse(n.responseText);o.disabled=!1,console.log("response = ",e),"block"==s.style.display&&(s.style.display="none"),s.style.display="block",s.classList="alert alert-success response-message fade show",s.innerHTML=e.message,setTimeout(()=>{o.innerHTML="Redirecting...",window.location.href=e.redirect_url},1500)}else{let e=JSON.parse(n.response);console.log("ðŸ›‘ xhr = ",n),console.log("ðŸ›‘ response = ",e),o.disabled=!1,o.innerHTML="Register","block"==s.style.display?(s.style.display="none",setTimeout(()=>{s.style.display="block",s.classList="alert alert-danger response-message fade show",s.innerHTML=e.message},300)):(s.style.display="block",s.classList="alert alert-danger response-message fade show",s.innerHTML=e.message)}},n.send(e)})}});const avatarOptions=document.querySelectorAll("#avatar-selector .avatar-option"),selectedAvatarInput=document.getElementById("selectedavatar"),avatarImage=document.getElementById("avatar");function handleAvatarOptionClick(e){avatarOptions.forEach(e=>{e.classList.remove("avatar-selected")});e=e.target,e.classList.add("avatar-selected"),e=e.getAttribute("data-bpavatar");selectedAvatarInput.value=e,avatarImage.src=bpapi.themedir+`lib/img/bizplanner-avatar_${e}.png`}function handleKeyUp(e){var n=document.querySelector(".form-control:focus"),t=document.getElementById("previous-question-btn"),o=document.getElementById("next-question-btn");o&&39===e.keyCode&&!n&&(o.classList.remove("btn-primary"),o.classList.add("btn-selected","btn-primary-outline"),window.setTimeout(function(){window.location.href=bpapi.next_question_url},300)),t&&37===e.keyCode&&!n&&(t.classList.remove("btn-primary"),t.classList.add("btn-selected","btn-primary-outline"),window.setTimeout(function(){window.location.href=bpapi.previous_question_url},300))}avatarOptions.forEach(e=>{e.addEventListener("click",handleAvatarOptionClick)}),document.addEventListener("keyup",handleKeyUp),document.addEventListener("DOMContentLoaded",function(){var e=document.querySelector("form#bizplanner-form input.form-control"),n=document.querySelector("form#bizplanner-form textarea.form-control");e&&e.focus(),n&&n.focus()});